<!DOCTYPE html>
<html style="margin: 0px; width: 100%; height: 100%;">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link rel="shortcut icon" href="#" />
  <style>
    @keyframes blinker {
      50% {
        opacity: 0.3;
      }
    }
  </style>
  <link rel="stylesheet" type="text/css" href="[PARENT]/Libraries/cshtml5.css" /> <!-- Path for production (JSIL-based version) -->
  <link rel="stylesheet" type="text/css" href="[PARENT]/[PARENT]/js_css/cshtml5.css" /> <!-- Path for production (NuGet-based version) of CSHTML5 -->
  <link rel="stylesheet" type="text/css" href="js_css/cshtml5.css" /> <!-- Path for production (NuGet-based version) of OpenSilver -->
  <link rel="stylesheet" type="text/css" href="[PARENT]/[PARENT]/[PARENT]/OtherLibraries/cshtml5.css" /> <!-- Path for development -->
  <link rel="stylesheet" type="text/css" href="libs/cshtml5.css" /> <!-- Path for tests -->

  <link rel="stylesheet" type="text/css" href="[PARENT]/Libraries/flatpickr.css" /> <!-- Path for production (JSIL) -->
  <link rel="stylesheet" type="text/css" href="[PARENT]/[PARENT]/js_css/flatpickr.css" /> <!-- Path for production (NuGet-based version) of CSHTML5 -->
  <link rel="stylesheet" type="text/css" href="js_css/flatpickr.css" /> <!-- Path for production (NuGet-based version) of OpenSilver -->
  <link rel="stylesheet" type="text/css" href="[PARENT]/[PARENT]/[PARENT]/OtherLibraries/flatpickr.css" /> <!-- Path for development -->
  <link rel="stylesheet" type="text/css" href="libs/flatpickr.css" /> <!-- Path for tests -->

  <script type="application/javascript" src="[PARENT]/Libraries/cshtml5.js"></script> <!-- Path for production (JSIL) -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/js_css/cshtml5.js"></script> <!-- Path for production (NuGet-based version) of CSHTML5 -->
  <script type="application/javascript" src="js_css/cshtml5.js"></script> <!-- Path for production (NuGet-based version) of OpenSilver -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/[PARENT]/OtherLibraries/cshtml5.js"></script> <!-- Path for development -->
  <script type="application/javascript" src="libs/cshtml5.js"></script> <!-- Path for tests -->

  <script type="application/javascript" src="[PARENT]/Libraries/velocity.js"></script> <!-- Path for production (JSIL) -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/js_css/velocity.js"></script> <!-- Path for production (NuGet-based version) of CSHTML5 -->
  <script type="application/javascript" src="js_css/velocity.js"></script> <!-- Path for production (NuGet-based version) of OpenSilver -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/[PARENT]/OtherLibraries/velocity.js"></script> <!-- Path for development -->
  <script type="application/javascript" src="libs/velocity.js"></script> <!-- Path for tests -->


  <script type="application/javascript" src="[PARENT]/Libraries/flatpickr.js"></script> <!-- Path for production (JSIL) -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/js_css/flatpickr.js"></script> <!-- Path for production (NuGet-based version) of CSHTML5 -->
  <script type="application/javascript" src="js_css/flatpickr.js"></script> <!-- Path for production (NuGet-based version) of OpenSilver -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/[PARENT]/OtherLibraries/flatpickr.js"></script> <!-- Path for development -->
  <script type="application/javascript" src="libs/flatpickr.js"></script> <!-- Path for tests -->

  <script type="application/javascript" src="[PARENT]/Libraries/ResizeSensor.js"></script> <!-- Path for production (JSIL) -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/js_css/ResizeSensor.js"></script> <!-- Path for production (NuGet-based version) of CSHTML5 -->
  <script type="application/javascript" src="js_css/ResizeSensor.js"></script> <!-- Path for production (NuGet-based version) of OpenSilver -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/[PARENT]/OtherLibraries/ResizeSensor.js"></script> <!-- Path for development -->
  <script type="application/javascript" src="libs/ResizeSensor.js"></script> <!-- Path for tests -->

  <script type="application/javascript" src="[PARENT]/Libraries/ResizeObserver.js"></script> <!-- Path for production (JSIL) -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/js_css/ResizeObserver.js"></script> <!-- Path for production (NuGet-based version) of CSHTML5 -->
  <script type="application/javascript" src="js_css/ResizeObserver.js"></script> <!-- Path for production (NuGet-based version) of OpenSilver -->
  <script type="application/javascript" src="[PARENT]/[PARENT]/[PARENT]/OtherLibraries/ResizeObserver.js"></script> <!-- Path for development -->
  <script type="application/javascript" src="libs/ResizeObserver.js"></script> <!-- Path for tests -->
  [SCRIPT_TO_READ_APPCONFIG_GOES_HERE]
  [SCRIPT_TO_READ_SERVICEREFERENCESCLIENTCONFIG_GOES_HERE]

</head>

<body>
  <div id="opensilver-root" style="position: relative; width: 100%; height: 100%; overflow-x: hidden; overflow-y: hidden">
    <div id="SimOverlay" style="position: absolute; width: 100%; height: 100%; overflow: hidden; z-index: 10000; display: none;">
    </div>
    <div id="SimElementHighlightBlueOuter" style="position: absolute; width: 100%; height: 100%; z-index: 10010; display: none; pointer-events: none;">
      <div id="SimElementHighlightBlue" style="position: absolute; width: 0px; height: 0px; border-color: blue; border-style: dashed; border-width: 4px; z-index: 10010; pointer-events: none; " />
    </div>
    <div id="SimElementHighlightRedOuter" style="position: absolute; width: 100%; height: 100%; z-index: 10011; display: none; pointer-events: none;">
      <div id="SimElementHighlightRed" style="position: absolute; width: 0px; height: 0px; border-color: red; border-style: dashed; border-width: 4px; z-index: 10011; pointer-events: none; animation: blinker 1.5s linear infinite;" />
    </div>
  </div>

  <script language="javascript">

    var simOverlay = document.getElementById("SimOverlay");
    var lastHighlightedElementId;

    window.onresize = function () {
      if (simOverlay.style.display == "") {
        simHighlightElement(lastHighlightedElementId, 1);
        simHighlightElement(lastHighlightedElementId, 2);
      }
    }

    var evenCallbackFunctionHolder;   //why this: despite the SimOverlay being on top and capturing events, OS divs were still getting mouseEnter and mouseLeave, probably could be better solved by a css wizard!

    function startXamlInspection() {
      simOverlay.style.display = "";
      evenCallbackFunctionHolder = document.eventCallback;
      document.eventCallback = function (callbackId, callerArgs, sync) { };
    }

    function stopXamlInspection() {
      simHighlightElement(null, 1);
      simHighlightElement(null, 2);
      simOverlay.style.display = 'none';
      document.eventCallback = evenCallbackFunctionHolder;
      evenCallbackFunctionHolder = null;
    }

    function onSimOverlayEvent(e) {
      e = e || event;
      e.preventDefault();
      e.stopPropagation();

      if (e.type == "mousemove") {
        chrome.webview.hostObjects.SimOverlayCallback.OnMouseMove(e.clientX, e.clientY);
      }

      if (e.type == "mousedown") {
        chrome.webview.hostObjects.SimOverlayCallback.OnMouseDown(e.clientX, e.clientY);
      }
    }

    simOverlay.addEventListener("mousedown", onSimOverlayEvent);
    simOverlay.addEventListener("mouseup", onSimOverlayEvent);
    simOverlay.addEventListener("mousemove", onSimOverlayEvent);
    simOverlay.addEventListener("mouseover", onSimOverlayEvent);

    function simHighlightElement(elementId, highlighClr) {
      var bounds = null;
      if (elementId) {
        var element = document.getElementByIdSafe(elementId);
        bounds = element.getBoundingClientRect();
      }
      simMoveElementHighlightDiv(highlighClr, bounds);
      lastHighlightedElementId = elementId;
    }

    function simMoveElementHighlightDiv(highlighClr, bounds) {
      var highlightDivId;
      if (highlighClr == 1)   //Blue
        highlightDivId = "SimElementHighlightBlue";
      else if (highlighClr == 2)    //Red
        highlightDivId = "SimElementHighlightRed";

      var highlightDiv = document.getElementById(highlightDivId);
      var highlightDivOuter = document.getElementById(highlightDivId + "Outer");

      if (!bounds) {
        highlightDivOuter.style.display = "none";
        return;
      }

      highlightDivOuter.style.display = "";
      highlightDiv.style.left = bounds.left - parseInt(highlightDiv.style.borderWidth) + "px";
      highlightDiv.style.top = bounds.top - parseInt(highlightDiv.style.borderWidth) + "px";
      highlightDiv.style.width = bounds.width + "px";
      highlightDiv.style.height = bounds.height + "px";

      if (highlighClr == 2) simMoveElementHighlightDiv(1, new DOMRect(0, 0, 0, 0));
    }

  </script>
</body>
</html>